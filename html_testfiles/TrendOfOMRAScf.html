<!DOCTYPE html>
<meta charset="utf-8">
<style>
	.chart div {
		font: 10px sans-serif;
		background-color: steelblue;
		text-align: right;
		padding: 3px;
		margin: 1px;
		color: white;
	}

</style>
<div class="chart"></div>

<script src="../js/ext_libs/d3.js"></script>
<script src="../js/libs/math2.js"></script>
<script src="../js/libs/mask.js"></script>
<script src="../js/libs/matrixOperations.js"></script>
<script src="../js/htmlElementFunctions2.js"></script>
<script src="../js/libs/pointEvaluation.js"></script>
<script src="../js/libs/gauss2.js"></script>
<script src="../js/ext_libs/function-plot.js"></script>
<script src="../js/ext_libs/numeric-1.2.6.js"></script>


<body>
	<div id="plot"> </div>
	<p> <input id="button1" type="button" value="start"> </p>
</body>

<script>

	
	/////////////////////////////////////////////////////////////////////////
   //First part of this Document collects coefficients with hight precisision:
   //Daubechies-Coefficients, Symmlets, Coiflets
   //////////////////////////////////////////////////////////////////////////
	var d2 = [(1 + Math.sqrt(3)) / 4, ((3 + Math.sqrt(3)) / 4), 
		(3 - Math.sqrt(3)) / 4, (1 - Math.sqrt(3)) / 4];
	var d3 = [0.47046721, 1.14111692, 0.650365, -0.19093442, 
		-0.12083221, 0.0498175];
	var d4 = [0.32580343, 1.01094572, 0.8922014, -0.03967503, 
		-0.26450717, 0.0436163, 0.0465036, -0.01498699];
		
	var coiflet=new Array(15);
	
	//N=1 2M=2 start=0 
	coiflet[1] = [1/2,1/2];
	
	//N=1 2M=4 start=-1 alpha = 0.604
	coiflet[2] = [3/8 - Math.sqrt(3)/8, 3/8 + Math.sqrt(3)/8, 1/8 + Math.sqrt(3)/8, 1/8 - Math.sqrt(3)/8];
	
	//N=1 2M=4 start =-1 alpha = 0.05
	coiflet[3] = [3/8 + Math.sqrt(3)/8, 3/8 - Math.sqrt(3)/8, 1/8 - Math.sqrt(3)/8, 1/8 + Math.sqrt(3)/8];
	
	//N=3 2M=6 start =-1 alpha = 0.041
	coiflet[4] = [(9+Math.sqrt(15))/32, (13-Math.sqrt(15))/32, (3-Math.sqrt(15))/16, (3+Math.sqrt(15))/16, 
					(1+Math.sqrt(15))/32, (-3-Math.sqrt(15))/32];
	
	//N=2 2M=6 start = -1 alpha = 1.232
	coiflet[5] = [(9-Math.sqrt(15))/32, (13+Math.sqrt(15))/32, (3+Math.sqrt(15))/16, (3-Math.sqrt(15))/16, 
					(1-Math.sqrt(15))/32, (-3+Math.sqrt(15))/32];
	
	//N=2 2M=6 start = -2 alpha=0.590
	coiflet[6] = [(1+Math.sqrt(7))/32, (5-Math.sqrt(7))/32, (7-Math.sqrt(7))/16, (7+Math.sqrt(7))/16,
				 (1+Math.sqrt(7))/32,(-3-Math.sqrt(7))/32];
				 
	//Bemerkung falscher Literaturwert - vorletzter Eintrag.			 
	//N=2 2M=6 start=-2 alpha=1.022 most symmetrical	
	coiflet[7] =[(1-Math.sqrt(7))/32, (5+Math.sqrt(7))/32, (7+Math.sqrt(7))/16, (7-Math.sqrt(7))/16,
				 (1-Math.sqrt(7))/32,(-3+Math.sqrt(7))/32];
				 
	//Bemerkung falscher Literaturwert - vorletzter Eintrag.	
	//N=3 2M=8 start = -1 alpha=0.147
	coiflet[8] = [15/64 +(3*Math.sqrt(1495))/1664, 59/128 - (Math.sqrt(1495)/832), 15/64 -(9*Math.sqrt(1495))/1664,
					15/128 + (3*Math.sqrt(1495)/832),5/64 + 9*(Math.sqrt(1495)/1664), -15/128 - (3*Math.sqrt(1495)/832),
					-3/64 - 3*(Math.sqrt(1495)/1664), (5/128+Math.sqrt(1495)/832)];
	
	//N=3 2M=8 start=-1 alpha=1.775
	coiflet[9] = [15/64 -(3*Math.sqrt(1495))/1664, 59/128 + (Math.sqrt(1495)/832), 15/64 +(9*Math.sqrt(1495))/1664,
					15/128 - (3*Math.sqrt(1495)/832),5/64 - 9*(Math.sqrt(1495)/1664), -15/128 + (3*Math.sqrt(1495)/832),
					-3/64 + 3*(Math.sqrt(1495)/1664), (5/128-Math.sqrt(1495)/832)];
	
	//N=3 2M=8 start=-2 alpha=1,422
	coiflet[10] = [21/640-3*Math.sqrt(31)/320, 51/320 + 3*Math.sqrt(31)/640, 257/640 + 9*Math.sqrt(31)/320, 
					147/320-9*Math.sqrt(31)/640, 63/640-9*Math.sqrt(31)/320, -47/320+9*Math.sqrt(31)/640, 
					-21/640 + 3*Math.sqrt(31)/320, 9/320-3*Math.sqrt(31)/640];
					
	//N=3 2M=8 start=-2 alpha = 0.936				
	coiflet[11] = [21/640+3*Math.sqrt(31)/320, 51/320 - 3*Math.sqrt(31)/640, 257/640 - 9*Math.sqrt(31)/320, 
					147/320+9*Math.sqrt(31)/640, 63/640+9*Math.sqrt(31)/320, -47/320-9*Math.sqrt(31)/640, 
					-21/640 - 3*Math.sqrt(31)/320, 9/320+3*Math.sqrt(31)/640];
					
	//N=3 2M=8 start= -3, alpha= 1.464
	coiflet[12] = [-1/32+Math.sqrt(7)/128, -3/128, 9/32-3*Math.sqrt(7)/128, 73/128, 
					9/32+3*Math.sqrt(7)/128, -9/128, -1/32 - Math.sqrt(7)/128,3/128];
					
	//N=3 2M=8 start = -3 alpha = 1.773 
	coiflet[13] = [-1/32-Math.sqrt(7)/128, -3/128, 9/32+3*Math.sqrt(7)/128, 73/128, 
					9/32-3*Math.sqrt(7)/128, -9/128, -1/32 + Math.sqrt(7)/128, 3/128];
		
	//Abweichung von der Literatur in den beide letzten Eintraegen je im letzten Nenner				
	//N=4 2M=12 start =-5 alpha = 1.707
	coiflet[14] = [7/1024 + Math.sqrt(31)/1024 - Math.sqrt(336+82*Math.sqrt(31))/2048,
					7/2048 - 3*Math.sqrt(31)/2048,
					-53/1024 - 3*Math.sqrt(31)/1024 + 5*Math.sqrt(336+82*Math.sqrt(31))/2048,
					-39/2048 + 11*Math.sqrt(31)/2048,
					151/512 + Math.sqrt(31)/512 - 5*Math.sqrt(336+82*Math.sqrt(31))/1024,
					555/1024-7*Math.sqrt(31)/1024,
					151/512 + Math.sqrt(31)/512 + 5*Math.sqrt(336+82*Math.sqrt(31))/1024,
					-47/1024 + 3*Math.sqrt(31)/1024,
					-53/1024 - 3*Math.sqrt(31)/1024 - 5*Math.sqrt(336+82*Math.sqrt(31))/2048,
					51/2048 + Math.sqrt(31)/2048,
					7/1024 + Math.sqrt(31)/1024 + Math.sqrt(336+82*Math.sqrt(31))/2048,
					-11/2048 - Math.sqrt(31)/2048];
					
	//N=4 2M=12 start =-5 alpha = 2.174			
	coiflet[15] = [7/1024 + Math.sqrt(31)/1024 + Math.sqrt(336+82*Math.sqrt(31))/2048,
					7/2048 - 3*Math.sqrt(31)/2048,
					-53/1024 - 3*Math.sqrt(31)/1024 - 5*Math.sqrt(336+82*Math.sqrt(31))/2048,
					-39/2048 + 11*Math.sqrt(31)/2048,
					151/512 + Math.sqrt(31)/512 + 5*Math.sqrt(336+82*Math.sqrt(31))/1024,
					555/1024-7*Math.sqrt(31)/1024,
					151/512 + Math.sqrt(31)/512 - 5*Math.sqrt(336+82*Math.sqrt(31))/1024,
					-47/1024 + 3*Math.sqrt(31)/1024,
					-53/1024 - 3*Math.sqrt(31)/1024 + 5*Math.sqrt(336+82*Math.sqrt(31))/2048,
					51/2048 + Math.sqrt(31)/2048,
					7/1024 + Math.sqrt(31)/1024 - Math.sqrt(336+82*Math.sqrt(31))/2048,
					-11/2048 - Math.sqrt(31)/2048];
					
	

	
	var symlets=new Array(7);	
	symlets[1]= [1,1];
	symlets[2] = [0.6830, 1.1830, 0.3170, -0.1830];
	symlets[3] = [0.4705, 1.1411, 0.6504, -0.1909, -0.1208, 0.0498];
	symlets[4] = [ 0.0456, -0.0178, -0.1403, 0.4212, 1.1367, 0.7037, -0.0419, -0.1071];
	
	function testCoiflets(){
		var sum;
		for(var j=1; j< coiflet.length; j++){
			var currentCoiflet=coiflet[j];
			var newCoeffs = new Array(currentCoiflet.length);
			sum=0;
			for(var i=0;i<currentCoiflet.length;i++){
				newCoeffs[i] = 2*currentCoiflet[i];
				sum+=newCoeffs[i];
			}

		}
	}
	///////////////////////////////////////////////////////////////////////
	///Second part is responsible for the short video
	//////////////////////////////////////////////////////////////////////
	
	
	//Functionallity of Button
	document.getElementById('button1').onclick = function() {
		if(document.getElementById('button1').value=='start'){
			console.log(document.getElementById('button1').value);
			document.getElementById("button1").value="stop";		}
		else if(document.getElementById('button1').value=='stop'){
			document.getElementById('button1').value='start';
		}
	};
	
	//global gespeicherte Werte und Plot-Instance
	var values = [];
	var plotInst;
	
	//erstellt die PlotInstance
	function makePlotInst() {			
					try{ 
							plotInst = functionPlot({
							target : '#plot',
							data : [{
								points : values,
								fnType : 'points',
								graphType : 'polyline',
							}]
						});		
					//return the wavelet plot as object
					return plotInst;
					
				}catch (err) {
					console.log(err);
					alert(err);
				}
		}
	makePlotInst();

	
	//berechnet in Abhaengigkeit des letzten Koeffizienten zl alle 4 neuen Koeffizienten,
	//und daraus die neue Werte, fuegt diese dem Plot hinzu und aktualisiert den Plot
	function newValuesToPlot(zl){
		var z = zl;
		var sigma = 0.5*Math.sqrt(-4*zl*zl+4*zl+1);
		var x = 1-zl;
		//1.case
		var w = sigma+0.5;		
		var y = 0.5-sigma;
		//2.case
		//var w = 0.5-sigma;
		//var y = sigma + 0.5;
		
		var coeffs=[w,x,y,z];
		console.log("aktuelle Koeffizienten", coeffs);
		values = iterativePointEvaluation2(coeffs, 0, 8, 0);
		plotInst.options.data[0].points=values;
		plotInst.draw();
	}
	
	//start and end-values of the last coefficient.
	//the other coefficients just depend on the last coefficient.
	var start= 0.5-Math.sqrt(2)/2;
	var end = 0.5 + Math.sqrt(2)/2;
	
	//zl is the value of the fourth coefficient. 
	function countdown (zl) {
		if(document.getElementById('button1').value=="start"){
			var timeout=window.setTimeout("countdown(" + zl + ")", 100);
			return undefined;
		}
  		if (zl == undefined) {
    	// Startwert
    		zl = start;
    		//console.log(zl);
  		}
  		newValuesToPlot(zl);
  		//Fortsetzungsbedingung-Bediungung
  		if (zl < end) {
    		zl=zl+0.005;
   		 // Funktion um 100ms verzoegert aufrufen
    		var timeout = window.setTimeout("countdown(" + zl + ")", 100);
    	//	console.log(zl);
  		}
	}
	// Countdown anstoÃŸen
	countdown();

</script>
