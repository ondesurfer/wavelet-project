<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<!-- Date: 2016-04-26 -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Wavelet Plot</title>
		<meta name="author" content="Simon" />
		<meta name="author" content="Andreas" />
		<!--include scripts and libraries-->
		<script src="js/ext_libs/d3.js"></script>
		<script src="js/libs/math2.js"></script>
		<script src="js/libs/matrixOperations.js"></script>
		<script src="js/ext_libs/function-plot.js"></script>
		<script src="js/numeric-1.2.6.js"></script>
		<script src="js/libs/gauss2.js"></script>

	</head>
	<body>
		    	 
    	<!--  <form id="draw_field"> 
			<input type="submit" value="Draw" />
		</form> -->
    
		<div id="plot"></div>
		
		<p>
			Plot library:
			<a href="https://github.com/maurizzzio/function-plot">
				https://github.com/maurizzzio/function-plot
			</a>
		</p>

		<script>
			var plotInstance;
			//var intervals = [[-1, 2],[2, 3]];
			//control points per interval
			/*var controlPoints = [[[-1, 2],[0, 0],[1, -2],[2, 0]],
			                     [[2,2],[2.5, 2.5],[2.7,2.7],[3,3]]];
			
			// vector with the x-coordinates of the controlPoints
			var controlPointsX = [];
			
			// vector with the y-coordinates of the controlPoints
			var controlPointsY = [];
			
			for(var i = 0; i < intervals.length; i++){
				controlPointsX[i] = [];
				controlPointsY[i] = [];
				for(var j = 0; j < controlPoints[i].length; j++){
					controlPointsX[i][j] = controlPoints[i][j][0];
					controlPointsY[i][j] = controlPoints[i][j][1];
				}	
			}*/
			var polyDegree = 3;
			var m = polyDegree + 1;
			/*var controlPointsX = [-1,0,1,2,2,2.5,2.7,3];
			var controlPointsY = [2,0,-2,0,2,2.5,2.7,3];*/
			var controlPointsX = [0,1,2,2, 2,5,5,5, 5,6,7,8];
			var controlPointsY = [1,2,2,2, 2,0,0,0, 0,-1,-1,0];
			var numberOfIntervals = controlPointsX.length/m;
			
			//test of extra-function
			var a = computeCubicSplineCoeffs(controlPointsX, controlPointsY);
			
			/*var splineCoeffs = [];	// coefficients per interval
			var M;
			// matrix with given constraints to the polynomial
			for(var i = 0; i < intervals.length; i++){
				var M = vander(controlPointsX[i]);
				splineCoeffs[i] = gaus2(M, controlPointsY[i]);
			}
			*/
			
			// create the data to plot
			var dataToPlot = [];
			var splineCoeffs = new Array(m);
			// nSamples = floor(samplesPropConst * interval-length)
			var nSamples;
			var samplesPropConst = 100;
			var intervalLength;
			var step = 0;	// step size per interval
			
			for(var i = 0; i < numberOfIntervals; i++){
				for(var j = 0; j < m; j++){
					splineCoeffs[j] = a[i*m + j];  
				}
				
				intervalLength = Math.abs(controlPointsX[(i + 1)*m - 1]
									- controlPointsX[i*m]);
				nSamples = Math.floor(samplesPropConst * intervalLength);
				step = intervalLength/nSamples;
				nSamples++;
				var values = createArray(nSamples,2);
				
				for(var j = 0; j < nSamples; j ++){
					values[j][0] = controlPointsX[i*m] + j*step;
					values[j][1] = horner(splineCoeffs, values[j][0]);
					//console.log(values[i][1]);
				}
				console.log(coeffsToStringRepresentation(splineCoeffs));
				/*dataToPlot[i] = {
						fn: coeffsToStringRepresentation(splineCoeffs),  
						range: [controlPointsX[4*i], controlPointsX[4*i + 3]]
				}*/
				
				dataToPlot[i] = {
									points : values,
									fnType : 'points',
									graphType : 'polyline'
								};
				
			}
			// add the control points to the plot
			for(var i = 0; i < controlPointsX.length; i++){
				dataToPlot[i + numberOfIntervals] = {
						points : [[controlPointsX[i], controlPointsY[i]]],
						fnType : 'points',
						graphType : 'scatter',
						color: 'pink'
					};
			}
			
			
			function draw() {
					try{ 
						var plotInst = functionPlot({
							target : '#plot',
							data :  dataToPlot
						});
					
					//return the wavelet plot as object
					return plotInst;
					
				}catch (err) {
					console.log(err);
					alert(err);
				}
			}
			
			draw();
			
			//add the draw-function to the draw-button
			//document.getElementById('draw_field').onsubmit = function(event) {
			//	event.preventDefault();
				//draw once and save the graph as object
			//	plotInstance = draw();
			//};
		</script>
	</body>
</html>

